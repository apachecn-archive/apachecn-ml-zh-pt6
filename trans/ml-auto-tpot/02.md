# 一、机器学习和自动化的理念

在这一章中，我们将快速复习基本的机器学习主题。像有监督的机器学习这样的主题被包括，伴随着回归和分类的基本概念。

我们将从各种角度理解为什么机器学习对 21 世纪的成功至关重要:学生、专业人士和商业用户，我们将讨论机器学习可以解决的不同类型的问题。

此外，我们将介绍自动化的概念，并了解它如何应用于机器学习任务。我们将讨论 Python 生态系统中的自动化选项，并比较它们的优缺点。我们将简要介绍 **TPOT** 图书馆，并讨论它在现代机器学习自动化中的作用。

本章将涵盖以下主题:

*   回顾机器学习的历史
*   审查自动化
*   将自动化应用于机器学习
*   Python 的自动化选项

# 技术要求

要完成这一章，你只需要安装 Python，以及基本的数据处理和机器学习库，比如`numpy`、`pandas`、`matplotlib`和`scikit-learn`。你将在第二章 *、深入了解 TPOT* 中学习如何在虚拟环境中安装和配置这些，但让我们保持这个简单。这些库预装在任何 Anaconda 发行版中，所以您不必担心。如果您使用的是原始 Python 而不是 Anaconda，那么从终端执行这一行将会安装所有需要的东西:

```
> pip install numpy pandas matplotlib scikit-learn
```

请记住，在虚拟环境中安装库总是一个好的做法，您将很快学会如何做到这一点。

本章的代码可以从这里下载:

[https://github . com/packt publishing/Machine-Learning-Automation-with-TPOT/tree/main/chapter 01](https://github.com/PacktPublishing/Machine-Learning-Automation-with-TPOT/tree/main/Chapter01)

# 回顾机器学习的历史

就在 25 年前(1994 年)，在*今日秀*—*的一个节目中，有人问了一个问题:“到底什么是互联网？”很难想象几十年前，普通人很难定义互联网是什么以及它是如何工作的。他们一点也不知道，仅仅在四分之一世纪后，我们就拥有了可以自我管理的智能系统，可供大众使用。*

机器学习的概念早在 1949 年由唐纳德·赫布提出。他提出了神经元兴奋和神经元之间通信的理论(*机器学习简史——data versity，* Foote，k .，2019 年 3 月 26 日)。他第一个引入了人工神经元的概念，它们的激活，以及它们通过权重的关系。

20 世纪 50 年代，亚瑟·塞缪尔开发了一个玩跳棋的计算机程序。当时的记忆相当有限，所以他设计了一个评分函数，试图根据棋盘上的位置来衡量每个玩家获胜的概率。该程序使用最小最大策略选择其下一步行动，该策略最终演变为最小最大算法(*机器学习简史-数据大学，*英国福特，3 月 26 日；2019).塞缪尔也是第一个提出术语**机器学习**的人。

弗兰克·罗森布拉特(Frank Rosenblatt)决定将赫布的人工脑细胞模型与阿瑟·塞缪尔(Arthur Samuel)的工作结合起来，创造出一种感知机。1957 年，一个感知器被规划为机器，这导致了建立一个 **Mark 1 感知器**机器，为图像分类而设计。

至少可以说，的想法似乎很有希望，但机器无法识别有用的视觉模式，这导致了进一步研究的停滞——这一时期被称为第一个人工智能冬天。直到 20 世纪 90 年代，感知器和神经网络模型才出现。

前面的几段话告诉了我们 20 世纪末机器学习和深度学习的状况。群体在神经网络方面取得了巨大的进步，而普通大众甚至难以理解互联网是什么。

为了让机器学习在现实世界中有用，科学家和研究人员需要两件事:

*   **数据**
*   **计算能力**

由于互联网的兴起，第一种方式变得越来越容易获得。第二次是慢慢进入指数增长阶段——无论是 CPU 性能还是存储容量。

尽管如此，机器学习在 20 世纪 90 年代末和 21 世纪初的状态与今天相去甚远。今天的硬件已经导致机器学习驱动的系统在生产应用中的使用显著增加。很难想象网飞不推荐电影，或者谷歌不从普通邮件中自动过滤垃圾邮件的世界。

但是，什么是机器学习呢？

## 什么是机器学习？

有很多关于机器学习的定义，有些更正式，有些不太正式。这里有几个值得一提的:

*   机器学习(Machine learning)是**人工智能** ( **AI** )的一个应用，它为系统提供了自动学习和从经验中改进的能力，而无需显式编程(*什么是机器学习？一个定义——专家系统，*专家系统团队；2020 年 5 月 6 日)。
*   机器学习是一个概念，即计算机程序可以在没有人工干预的情况下学习和适应新数据(*机器学习 Investopedia，* Frankenfield，j；2020 年 8 月 31 日)。
*   机器学习(Machine learning)是计算机科学的一个领域，旨在教会计算机如何在没有显式编程的情况下学习和行动(*Machine Learning–DeepAI，*Deep AI Team；2020 年 5 月 17 日)。

尽管这些定义表达方式不同，但它们传达了相同的信息。机器学习旨在开发一种能够在没有人类干预的情况下从数据中学习的系统或算法。

数据科学家的目标不是指导算法如何学习，而是为算法提供足够大小和准备好的数据集，并简要说明数据集变量之间的关系。例如，假设目标是生成一个能够预测房价的模型。在这种情况下，数据集应该提供对大量历史价格的观察，通过位置、大小、房间数量、年龄、是否有阳台或车库等变量进行测量。

由机器学习算法来决定哪些特征是重要的，哪些是不重要的，因此，哪些特征具有显著的预测能力。上一段中的例子解释了用**监督机器学习**方法解决**回归**问题的想法。我们将很快深入这两个概念，所以如果您不太理解，请不要担心。

此外，我们可能想要建立一个模型，可以相当有把握地预测客户是否可能流失(违约)。有用的特性包括客户正在使用的服务列表、他们使用该服务的时间、之前的付款是否按时完成等等。这是监督机器学习问题的另一个例子，但目标变量(流失)是分类的(是或否)，而不是连续的，就像上一个例子中的情况一样。我们把这类问题叫做**分类机器学习问题**。

机器学习不仅限于回归和分类。它被应用于许多其他领域，如聚类和维数约减。这些都属于**无监督机器学习**技术的范畴。本章不讨论这些话题。

但首先，我们来回答一个关于机器学习模型可用性的问题，讨论一下谁使用这些模型，在什么情况下使用。

## 公司在哪些领域使用机器学习？

一言以蔽之——无处不在。但是你必须继续阅读才能得到一个完整的图片。近一二十年来，几乎每个行业都采用了机器学习。主要原因是硬件的进步。此外，机器学习对于更广泛的大众来说变得更容易使用和理解。

不可能列出每个使用机器学习的行业，并进一步讨论它解决的具体问题。更容易的任务是列出无法从机器学习中受益的行业，因为这些行业的数量要少得多。

在这一节中，我们将只关注那些比较有名的行业。

以下是机器学习的十个最常见的使用案例的列表和解释，既从行业的角度，也作为一个总体概述:

*   **金融行业**:机器学习在金融领域越来越受欢迎。银行和金融机构可以利用它做出更明智的决策。通过机器学习，银行可以检测出最有可能不偿还贷款的客户。此外，银行可以使用机器学习方法来跟踪和了解客户的消费模式。这可以产生令双方满意的更加个性化的服务。机器学习还可以通过一些客户账户上的意外行为来检测异常和欺诈。
*   **医疗行业**:最近的医学进步至少部分归功于机器学习的进步。可以使用各种预测方法在早期阶段检测疾病，医学专家可以基于这些方法构建个性化的治疗和恢复计划。例如，可以使用诸如图像分类和对象检测的计算机视觉技术来对肺部图像进行分类。这些技术也可用于根据单幅图像或一系列图像检测肿瘤的存在。
*   **图像识别**:这是可能是机器学习最广泛的应用，因为它可以应用于任何行业。你可以从简单的猫和狗的图像分类到非洲濒危动物的皮肤状况分类。图像识别还可以用于检测图像中是否存在感兴趣的对象。例如*中的瓦尔多在哪里的自动检测？*游戏的逻辑和自动驾驶汽车中检测行人的算法大致相同。
*   **语音识别**:又一个激动人心又充满希望的领域。大致的想法是，算法可以自动识别音频片段中的口语单词，然后将其转换为文本文件。一些比较有名的应用程序是电器控制(用语音命令控制空调)、语音拨号(自动识别只通过语音呼叫的联系人)和互联网搜索(用语音浏览网页)。这些只是立即浮现在脑海中的几个例子。开发自动语音识别软件具有挑战性。并非所有语言都受支持，许多非母语人士在讲外语时带有口音，ML 算法可能很难识别这些口音。
*   **自然语言处理** ( **NLP** ):私营部门的公司可以从 NLP 中受益匪浅。例如，如果客户留下的在线评论太多而无法手动分类，公司可以使用 NLP 来分析这些评论的情绪。此外，公司可以在网页上创建聊天机器人，立即与用户开始对话，从而带来更多潜在的销售。举个更高级的例子，NLP 可以用来写长文档的摘要，甚至可以用来分割和分析蛋白质序列。
*   **推荐系统**:截至 2020 年底，很难想象这样一个世界:谷歌不会根据你过去的行为定制搜索结果，亚马逊不会自动推荐类似的产品，网飞不会根据你过去的手表推荐电影和电视节目，Spotify 不会推荐不知何故在你眼皮底下飞过的音乐。这些只是几个例子，但是不难认识到推荐系统的重要性。
*   垃圾邮件检测:就像很难想象一个搜索结果不是按照你的喜好定制的世界一样，也很难想象一个电子邮件服务不会自动过滤掉关于吸尘器打折的信息。我们每天都被信息轰炸，自动垃圾邮件检测算法可以帮助我们专注于重要的事情。
*   自动化交易:即使是股票市场也发展得太快，没有自动化手段也无法完全捕捉到正在发生的事情。开发交易机器人并不容易，但机器学习可以帮助你根据大量的历史数据选择最佳的买卖时机。如果完全自动化，你可以一边在沙滩上啜饮玛格丽塔酒，一边观察你的钱是如何创造金钱的。对你们中的一些人来说，这听起来有些牵强，但是有了健壮的模型和大量的领域知识，我看不出有什么不可以。
*   **异常检测**:让我们拨回我们的银行业例子。银行可以将异常检测算法用于各种用例，例如标记可疑交易和活动。最近，我一直在使用异常检测算法来检测网络流量中的可疑行为，目标是自动检测网络攻击和恶意软件。如果数据以正确的方式格式化，这是另一种适用于任何行业的技术。
*   **社交网络**:脸书向你推荐了多少次你可能认识的人？还是 YouTube 推荐了你刚才想的话题的视频？不，他们没有读懂你的想法，但是他们知道你过去的行为和决定，并且能够相当自信地预测你的下一步行动。

这些只是机器学习可以做什么的几个例子——无论如何都不是一个详尽的列表。现在，您已经熟悉了机器学习的简史，并且知道机器学习如何应用于各种任务。

下一节将简要回顾有监督的机器学习技术，如回归和分类。

## 监督学习

大多数实际机器学习问题都是通过**监督学习**算法解决的。监督学习指的是这样一种情况:你有一个输入变量(预测器)，通常用 X 表示，一个输出变量(你试图预测的东西)，通常用 y 表示。

特征(X)用大写字母表示而目标变量(y)不用是有原因的。在数学术语中，X 表示特征矩阵，矩阵通常用大写字母表示。另一方面，y 是一个向量，小写字母通常用来表示向量。

监督机器学习算法的目标是学习可以将任何输入转换为输出的函数。监督学习算法的最一般的数学表示由以下公式表示:

![Figure 1.1 – General supervised learning formula
](img/B16954_01_001.jpg)

图 1.1–一般监督学习公式

我们必须应用两个修正中的一个来使这个公式可被接受。第一种是用 y-hat 代替 y，因为 y 一般表示真实值，y-hat 表示预测值。我们可以做的第二个修正是加入误差项，因为只有这样我们才能得到另一端 y 的正确值。误差项代表不可约误差——不能通过进一步训练减少的误差类型。

下面是第一个修正后的公式:

![Figure 1.2 – Corrected supervised learning formula (v1)
](img/B16954_01_002.jpg)

图 1.2–修正的监督学习公式(v1)

这是第二个:

![Figure 1.3 – Corrected supervised learning formula (v2)
](img/B16954_01_003.jpg)

图 1.3–修正的监督学习公式(v2)

更常见的是看到第二个，但不要被任何格式所迷惑——这些公式通常表示相同的东西。

受监督的机器学习被称为“受监督的”,因为我们有标记的数据供我们使用。由于特性和目标的讨论，您可能已经选择了这个。这意味着我们已经有了正确的答案，因此，我们知道 X 的哪些组合产生了 y 的相应值。

最终目标是从可用的数据中做出最好的概括。我们希望产生最无偏的模型，能够对新的、看不见的数据进行归纳。过度拟合、欠拟合和偏差-方差权衡的概念对于生成这样的模型很重要，但它们不在本书的范围内。

正如我们已经提到的，监督学习问题分为两大类:

*   **回归**:目标变量本质上是连续的，比如以美元表示的房价、以华氏度表示的温度、以磅表示的体重、以英寸表示的身高等等。
*   **分类**:目标变量是一个类别——可以是二元的(真/假、正/负、疾病/无疾病)，也可以是多类的(无症状/轻度症状/重度症状、学校成绩等等)。

回归和分类都将在下面的章节中探讨。

### 回归

正如前面几节简要讨论的那样，回归指的是目标变量连续的现象。目标变量可以代表价格、体重或身高等。

最常见的回归类型是**线性回归**，这是一种假设变量之间存在线性关系的模型。线性回归进一步分为简单线性回归(只有一个特征)和多元线性回归(多个特征)。

重要说明

请记住，线性回归不是唯一的回归类型。您可以使用决策树、随机森林、支持向量机、梯度推进和人工神经网络等算法来执行回归任务，但同样的概念仍然适用。

为了快速回顾一下回归概念，我们将声明一个简单的`pandas.DataFrame`对象，由两列组成——`Living area`和`Price`。目标是仅根据居住空间来预测价格。我们在这里使用简单的线性回归模型，只是因为它使数据可视化过程更简单，最终结果是使回归概念更容易理解:

1.  以下是数据集–两列都包含任意值和虚构值:

    ```
    import pandas as pd  df = pd.DataFrame({     'LivingArea': [300, 356, 501, 407, 950, 782,                     664, 456, 673, 821, 1024, 900,                     512, 551, 510, 625, 718, 850],     'Price': [100, 120, 180, 152, 320, 260,                210, 150, 245, 300, 390, 305,                175, 185, 160, 224, 280, 299] })
    ```

2.  为了可视化这些数据点，我们将使用`matplotlib`库。默认情况下，这个库看起来不太吸引人，所以对`matplotlib.rcParams`包做了一些调整:

    ```
    import matplotlib.pyplot as plt  from matplotlib import rcParams rcParams['figure.figsize'] = 14, 8 rcParams['axes.spines.top'] = False rcParams['axes.spines.right'] = False
    ```

3.  The following options make the charts larger by default, and remove the borders (spines) on the top and right. The following code snippet visualizes our dataset as a two-dimensional scatter plot:

    ```
    plt.scatter(df['LivingArea'], df['Price'], color='#7e7e7e', s=200)
    plt.title('Living area vs. Price (000 USD)', size=20)
    plt.xlabel('Living area', size=14)
    plt.ylabel('Price (000 USD)', size=14)
    plt.show()
    ```

    上述代码生成了下图:

    ![Figure 1.4 – Regression – Scatter plot of living area and price (000 USD)
    ](img/B16954_01_004.jpg)

    图 1.4–回归–居住面积和价格散点图(千美元)

4.  训练使用`scikit-learn`库最容易实现线性回归模型。该库包含大量不同的算法和技术，我们可以应用于我们的数据。`sklearn-learn.linear_model`模块包含了`LinearRegression`类。我们将使用它在整个数据集上训练模型，然后在整个数据集上进行预测。这不是你在生产环境中通常会做的事情，但是对于进一步理解模型是如何工作的是必不可少的:

    ```
    from sklearn.linear_model import LinearRegression model = LinearRegression() model.fit(df[['LivingArea']], df[['Price']]) preds = model.predict(df[['LivingArea']]) df['Predicted'] = preds
    ```

5.  We've assigned the prediction as yet another dataset column, just to make data visualization simpler. Once again, we can create a chart containing the entire dataset as a scatter plot. This time, we will add a line that represents the *line of best fit* – the line where the error is smallest:

    ```
    plt.scatter(df['LivingArea'], df['Price'], color='#7e7e7e', s=200, label='Data points')
    plt.plot(df['LivingArea'], df['Predicted'], color='#040404', label='Best fit line')
    plt.title('Living area vs. Price (000 USD)', size=20)
    plt.xlabel('Living area', size=14)
    plt.ylabel('Price (000 USD)', size=14)
    plt.legend()
    plt.show()
    ```

    前面的代码产生如下图形:

    ![Figure 1.5 – Regression – Scatter plot of living area and price (000 USD) with the line of best fit
    ](img/B16954_01_005.jpg)

    图 1.5–回归–居住面积和价格散点图(以千美元计)，带最佳拟合线

6.  正如我们所见，简单的线性回归模型几乎完美地捕捉到了我们的数据集。这并不奇怪，因为数据集就是为此目的而创建的。新的预测将沿着最佳拟合线进行。例如，如果我们想预测居住面积为 1，000 平方米的房子的价格，该模型将做出略高于 350，000 美元的预测。代码中的实现很简单:

    ```
    model.predict([[1000]]) >>> array([[356.18038708]])
    ```

7.  Further, if you were interested in evaluating this simple linear regression model, metrics like *R2* and *RMSE* are a good choice. R2 measures the goodness of fit, ergo it tells us how much variance our model captures (ranging from 0 to 1). It is more formally referred to as the *coefficient of determination*. RMSE measures how wrong the model is on average, in the unit of interest. For example, an RMSE value of 10 would mean that on average our model is wrong by $10K, in either the positive or negative direction.

    R2 分数和 RMSE 的计算如下:

    ```
    import numpy as np
    from sklearn.metrics import r2_score, mean_squared_error
    rmse = lambda y, ypred: np.sqrt(mean_squared_error(y, ypred))
    model_r2 = r2_score(df['Price'], df['Predicted'])
    model_rmse = rmse(df['Price'], df['Predicted'])
    print(f'R2 score: {model_r2:.2f}')
    print(f'RMSE: {model_rmse:.2f}')
    >>> R2 score: 0.97
    >>> RMSE: 13.88
    ```

总之，我们已经建立了一个简单但准确的模型。不要指望现实世界中的数据会表现得这么好，也不要指望在大多数时候能构建出如此精确的模型。模型选择和调整的过程很繁琐，容易出现人为错误，这就是自动化库如 **TPOT** 发挥作用的地方。

我们将在下一节讨论分类复习，同样是关于这个相当简单的例子。

### 分类

机器学习中的分类是指目标变量为分类的一类问题。我们可以将分类问题中的*回归*部分的示例转换为类别，例如*已售/未售*。

简而言之，分类算法在各种场景中帮助我们，例如预测客户流失，肿瘤是否是恶性的，某人是否患有给定的疾病，等等。你明白了。

分类任务可以进一步分为二元分类任务和多类分类任务。在这一节中，我们将简要探讨二进制分类任务。最基本的分类算法是*逻辑回归*，我们将在本节中使用它来构建一个简单的分类器。

注意

请记住，在执行分类任务时，您不仅仅局限于逻辑回归。相反，使用逻辑回归模型作为基线，并在生产中使用更复杂的算法是很好的实践。更复杂的算法包括决策树、随机森林、梯度推进和人工神经网络。

在本例中，数据完全是虚构的，并且是任意的:

1.  我们有两列——第一列表示某种度量(称为`Radius`),第二列表示分类(0 或 1)。数据集由以下 Python 代码构建:

    ```
    import numpy as np import pandas as pd df = pd.DataFrame({     'Radius': [0.3, 0.1, 1.7, 0.4, 1.9, 2.1, 0.25,                 0.4, 2.0, 1.5, 0.6, 0.5, 1.8, 0.25],     'Class': [0, 0, 1, 0, 1, 1, 0,                0, 1, 1, 0, 0, 1, 0] })
    ```

2.  出于可视化的目的，我们将再次使用`matplotlib`库。下面是如何导入它并使它看起来更有吸引力:

    ```
    import matplotlib.pyplot as plt  from matplotlib import rcParams rcParams['figure.figsize'] = 14, 8 rcParams['axes.spines.top'] = False rcParams['axes.spines.right'] = False
    ```

3.  We can reuse the same logic from the previous regression example to make a visualization. This time, however, we won't see data that closely resembles a line. Instead, we'll see data points separated into two groups. On the lower left are the data points where the `Class` attribute is 0, and on the right where it's 1:

    ```
    plt.scatter(df['Radius'], df['Class'], color='#7e7e7e', s=200)
    plt.title('Radius classification', size=20)
    plt.xlabel('Radius (cm)', size=14)
    plt.ylabel('Class', size=14)
    plt.show()
    ```

    下图是上述代码的输出:

    ![Figure 1.6 – Classification – Scatter plot between measurements and classes
    ](img/B16954_01_006.jpg)

    图 1.6–分类–测量值和类别之间的散点图

    分类模型的目标不是产生一条最佳拟合线，而是在类之间画出最佳可能的分离。

4.  逻辑回归模型在`sklearn.linear_model`软件包中可用。我们将使用它在整个数据集上训练模型，然后在整个数据集上进行预测。同样，这不是我们将在本书后面继续做的事情，但是对于深入了解模型的内部工作是必不可少的:

    ```
    from sklearn.linear_model import LogisticRegression model = LogisticRegression() model.fit(df[['Radius']], df['Class']) preds = model.predict(df[['Radius']]) df['Predicted'] = preds
    ```

5.  我们现在可以使用该模型对任意数量的 X 值进行预测，范围从整个数据集中的最小值到最大值。通过`np.linspace`方法获得均匀间隔的数字范围。它有三个参数——`start`、`stop`和元素的数量。我们将元素的数量设置为`1000`。
6.  Then, we can make a line that indicates the probabilities for every value of X generated. By doing so, we can visualize the decision boundary of the model:

    ```
    xs = np.linspace(0, df['Radius'].max() + 0.1, 1000)
    ys = [model.predict([[x]]) for x in xs]
    plt.scatter(df['Radius'], df['Class'], color='#7e7e7e', s=200, label='Data points')
    plt.plot(xs, ys, color='#040404', label='Decision boundary')
    plt.title('Radius classification', size=20)
    plt.xlabel('Radius (cm)', size=14)
    plt.ylabel('Class', size=14)
    plt.legend()
    plt.show()
    ```

    上述代码生成了以下可视化效果:

    ![Figure 1.7 – Classification – Scatter plot between measurements and classes and the decision boundary
    ](img/B16954_01_007.jpg)

    图 1.7–分类–测量值、类别和决策边界之间的散点图

    我们的分类模型基本上是阶跃函数，对于这个简单的问题是可以理解的。正确分类数据集中的每个实例并不需要更复杂的事情。情况不会总是这样，但以后会有更多的介绍。

7.  混淆矩阵是评估分类模型的最佳方法之一。我们的*负*类是 0，*正*类是 1。混淆矩阵只是一个正方形矩阵，显示以下内容:
    *   *真底片*:左上角的号。这些实例的类别为 0，并被模型预测为 0。
    *   *假阴性*:左下方数字。这些实例的类为 0，但被模型预测为 1。
    *   *误报*:右上方数字。这些实例的类别为 1，但被模型预测为 0。
    *   *True positives*: The bottom right number. These are instances that had the class of 1 and were predicted as 1 by the model.

        尽可能多的阅读前面的列表，以完全理解这个想法。混淆矩阵是分类器评估中的一个基本概念，本书后面的章节假设你知道如何解释它。

8.  The confusion matrix is available in the `sklearn.metrics` package. Here's how to import it and obtain the results:

    ```
    from sklearn.metrics import confusion_matrix
    confusion_matrix(df['Class'], df['Predicted'])
    ```

    结果如下:

![Figure 1.8 – Classification – Evaluation with a confusion matrix
](img/B16954_01_008.jpg)

图 1.8–分类–用混淆矩阵进行评估

上图显示，我们的模型能够正确地对每个实例进行分类。根据经验，如果从左下角延伸到右上角的对角线元素为零，这意味着模型是 100%准确的。

混淆矩阵解释总结了我们对监督机器学习方法的简短复习。接下来，我们将深入研究自动化的思想，并讨论为什么我们在机器学习中需要它。

# 审核自动化

本节简要讨论自动化的概念，我们为什么需要它，以及它如何应用于机器学习。我们还将回答机器学习取代人类工作的古老问题，以及自动化在这方面的作用。

自动化在现代世界发挥着巨大的作用，在过去的几个世纪里，它让我们完全摆脱了危险和重复性工作中的人为因素。这在就业市场上开辟了一系列新的可能性，在就业市场上，工作通常基于一些无法自动化的东西，至少目前是这样。

但首先，我们必须了解什么是自动化。

## 什么是自动化？

有许多句法上不同的定义，但是它们都有相同的基本概念。下面的例子用最简单的语言表达了这个想法:

自动化是一个宽泛的术语，可以涵盖许多技术领域，在这些领域中，人类的投入被最小化(*什么是自动化？–IBM，* IBM 团队；2020 年 2 月 28 日)。

定义的本质部分是人类输入的最小化*。自动化过程完全或几乎完全由机器管理。几年前，机器是自动化枯燥的常规任务，把创造性的事情留给人们的好方法。正如你可能猜到的，机器不太擅长创造性的任务。也就是说，他们直到最近才。*

机器学习不仅为我们提供了自动化计算、电子表格管理和费用跟踪的机制，还为我们提供了更多的认知任务，如决策。这个领域每天都在发展，很难说我们到底什么时候可以期待机器接管一些更有创造性的工作。

机器学习中自动化的概念将在后面讨论，但重要的是要记住，机器学习可以将自动化带到一个全新的水平。并非每种形式的自动化都是相同的，根据复杂性，普遍接受的自动化划分为四个级别:

*   **基础自动化**:最简单任务的自动化。**机器人流程自动化** ( **RPA** )是完美的例子，因为它的目标是使用软件机器人来自动化重复性任务。这个自动化类别的最终目标是完全消除等式中的人为因素，从而更快无误地执行重复性任务。
*   **流程自动化**:它使用并将基本的自动化技术应用于整个业务流程。最终目标是完全自动化业务活动，让人类只给出最终批准。
*   **集成自动化**:它使用人类定义的规则来模仿人类完成任务的行为。最终目标是在更复杂的业务任务中最大限度地减少人工干预。
*   **AI 自动化**:自动化最复杂的形式。目标是拥有一台可以根据以前的情况和在这些情况下做出的决定进行学习和决策的机器。

你现在知道什么是自动化，接下来，我们将讨论为什么它在 21 世纪是必须的。

## 为什么需要自动化？

公司和顾客都能从自动化中获益。自动化可以改善资源分配和管理，并使业务扩展过程更容易。由于自动化，公司可以提供更可靠和一致的服务，从而带来更一致的用户体验。最终结果是，与服务质量不一致的情况相比，客户更有可能购买和花费更多。

从长远来看，自动化简化和减少了人类活动，降低了成本。此外，任何自动化过程都可能比由人类执行的相同过程执行得更好。机器不会累，没有一天不顺心，也不要求工资。

下面的列表显示了自动化的一些最重要的原因:

*   节省时间:自动化通过让机器代替人类来完成日常工作，从而简化了日常工作。最终结果是，人类可以从一开始就专注于更具创造性的任务。
*   **降低成本**:自动化应该被认为是一项长期投资。当然，它会带来一些启动成本，但如果自动化正确实施，这些成本会很快收回。
*   **准确性和一致性**:如前所述，人类很容易出错、倒霉和前后不一致。机器就不是这样了。
*   **工作流程增强**:由于自动化，更多的时间可以花在重要的任务上，例如为客户提供个人协助。如果员工的轮班不仅仅是重复性和例行任务，他们往往会更开心，并取得更好的结果。

困难的问题不是“你自动化了吗？”而是，*“你什么时候实现自动化？”*关于这个话题有很多不同的观点，没有单一的正确或错误答案。决定何时自动化取决于您可用的预算和机会成本(如果时间不是问题，您能够做出的决策/投资)。

对大多数公司来说，将你擅长的事情自动化并专注于需要改进的领域是一条通用的经验法则。即使作为一个个体，你也很有可能每天或每周都在做一些可以用通俗易懂的语言描述的事情。如果一件事情可以一步一步地描述，它就可以自动化。

但是自动化的概念如何应用于机器学习呢？机器学习和自动化是同义词吗？这就是我们接下来要讨论的。

## 机器学习和自动化是一回事吗？

嗯，没有。但是机器学习可以把自动化带到一个完全不同的水平。让我们回顾一下前几段讨论过的自动化的四个级别。只有最后一种使用了机器学习，而且是自动化的最高级形式。

让我们把一天中的一项活动看作一个*过程*。如果你确切地知道这个过程将如何开始和结束，以及在这之间将发生的一切，以及以何种顺序发生，那么这个过程可以在没有机器学习的情况下实现自动化。

这里有一个例子。在过去的几个月里，你一直在关注你想搬到的地区的房地产价格。每天早上你给自己泡一杯咖啡，坐在笔记本电脑前，浏览一个房地产网站。您可以过滤结果，只查看最近 24 小时内投放的广告，然后将位置、单价、房间数量等数据输入到电子表格中。

这个过程大约需要你一天中的一个小时，也就是每个月 30 个小时。这已经很多了。在 30 个小时内，你可以轻松地阅读一本书或参加一个在线课程，以进一步发展你在其他领域的技能。本段中描述的过程可以容易地自动化，而不需要机器学习。

让我们看另一个例子。你每天花很多时间在股票市场上，决定买什么卖什么。这个过程不同于前一个，因为它涉及到某种决策。问题是，有了所有在线可用的数据集，一个熟练的个人可以使用机器学习方法来自动化购买/销售决策过程。

这是包括机器学习的自动化形式，但不，机器学习和自动化不是同义词。两者缺一不可。

以下部分将详细讨论自动化在机器学习中的作用(反之亦然)，并回答我们试图自动化的内容以及在当今时代如何实现。

# 将自动化应用于机器学习

到目前为止，我们已经讨论了自动化的概念和各种类型的自动化，但是自动化和机器学习之间有什么联系呢？我们在机器学习中试图自动化的到底是什么？

这就是这个部分的目的。在本节结束时，您将知道术语*带机器学习的自动化*和*自动化机器学习*之间的区别。这两个听起来很相似，但实际上是非常不同的。

## 我们试图自动化什么？

让我们搞清楚一件事——*机器学习流程自动化*与*机器学习业务流程自动化*无关。在前一种情况下，我们试图自动化机器学习本身，从而自动化选择最佳模型和最佳超参数的过程。后者指的是在机器学习的帮助下自动化一个业务流程；例如，建立一个决策系统，根据历史数据决定何时买入或卖出一只股票。

记住这一区别至关重要。这本书的主要焦点是展示自动化库如何被用来自动化机器学习的过程。通过这样做，您将遵循完全相同的方法，而不管数据集如何，并且总是以可能的最佳模型结束。

选择合适的机器学习算法并不是一件容易的事情。只需看一下下图:

![Figure 1.9 – Algorithms in scikit-learn (source: Scikit-learn: Machine Learning in Python, Pedregosa et al., JMLR 12, pp. 2825-2830, 2011)
](img/B16954_01_009.jpg)

图 1.9-sci kit-learn 中的算法(来源:sci kit-learn:Python 中的机器学习，Pedregosa 等人，JMLR 12，第 2825-2830 页，2011)

如您所见，选择合适的算法需要多种决策。此外，每个算法都有自己的一组超参数(由工程师指定的参数)。更糟糕的是，这些超参数中的一些在本质上是连续的，所以当你把所有这些加起来时，有几十万甚至几百万个超参数组合需要你作为工程师来测试。

每个超参数组合都需要训练和评估一个全新的模型。像**网格搜索**这样的概念可以帮助你避免写几十个嵌套循环，但这远不是最优解。

现代机器学习工程师不会把时间和精力花在模型训练和优化上——而是花在提高数据质量和可用性上。超参数调整可以挤压额外增加的 2%的精度，但是数据质量可以决定你项目的成败。

接下来，我们将更深入地研究超参数，并演示为什么手动搜索最优参数不是一个好主意。

## 参数太多的问题

让我们来看看最流行的机器学习算法之一—`XGBoost`可用的一些超参数。下面的列表显示了一般的方法:

*   `booster`
*   `verbosity`
*   `validate_parameters`
*   `nthread`
*   `disable_default_eval_metric`
*   `num_pbuffer`
*   `num_feature`

这还不算多，这些超参数有些是算法自动设置的。问题在于进一步的选择。例如，如果您选择`gbtree`作为`booster`参数的值，您可以立即调整以下值:

*   `eta`
*   `gamma`
*   `max_depth`
*   `min_child_weight`
*   `max_delta_step`
*   `subsample`
*   `sampling_method`
*   `colsample_bytree`
*   `colsample_bylevel`
*   `colsample_bynode`
*   `lambda`
*   `alpha`
*   `tree_method`
*   `sketch_eps`
*   `scale_pos_weight`
*   `updater`
*   `refresher_leaf`
*   `process_type`
*   `grow_policy`
*   `max_leaves`
*   `max_bin`
*   `predictor`
*   `num_parallel_tree`
*   `monotone_constraints`
*   `interaction_constraints`

这已经很多了！如前所述，一些超参数接受连续值，这极大地增加了组合的总数。这是最后的锦上添花——这些只是单个模型的超参数。不同的模型有不同的超参数，这使得调整过程更加耗时。

简而言之，模型选择和超参数调整不是你应该手动完成的事情。有更重要的任务需要你花精力去完成。即使没有其他事情要做，我也更喜欢去吃午饭，而不是在一周的任何一天手动调谐。

AutoML 使我们能够做到这一点，所以我们将在下一节中简要探讨它。

## 什么是 AutoML？

**AutoML** 代表**自动化机器学习**，其首要目标是减少或完全消除数据科学家在构建机器学习模型中的作用。乍一听这句话可能有些刺耳。我知道你在想什么。但不是——AutoML 无法取代数据科学家和其他数据专业人士。

在最好的情况下，AutoML 技术使其他软件工程师能够在他们的应用程序中利用机器学习的力量，而不需要有坚实的 ML 背景。只有在充分收集和准备了数据的情况下，这种最佳情况才是可能的——这不是后端开发人员的专长。

对于非数据科学家来说，更困难的是，机器学习过程通常需要大量的特征工程。这一步可以跳过，但通常情况下，这将导致模型不佳。

总之，AutoML 不会取代数据科学家，恰恰相反——它是为了让数据科学家的生活更轻松。AutoML 只在最大程度上自动选择和调整模型。

有一些 AutoML 服务标榜自己是完全自动化的，甚至是数据准备和功能工程工作，但那只是通过将各种功能组合在一起，并做出一些大多数时间都无法解释的东西。机器不知道变量之间的真实关系。这是数据科学家的工作。

# 自动化选项

AutoML 不是一个新的概念。这个想法和一些实现已经存在很多年了，总体来说得到了积极的反馈。然而，由于缺乏了解，一些人未能在他们的组织中实现和充分利用 AutoML 解决方案。

AutoML 不能做所有的事情——仍然需要有人来收集数据、存储数据和准备数据。这不是一个小任务，通常需要大量的领域知识。只有到那时，自动化解决方案才能被充分利用。

本节探讨了实现 AutoML 解决方案的几个选项。我们将比较一个用 Python 编写的基于代码的工具和一个作为浏览器应用程序交付的工具，这意味着不需要编码。我们先从基于代码的开始。

## PyCaret

**py caret**已经广泛用于用尽可能少的代码制作生产就绪的机器学习模型。这是一个完全免费的解决方案，能够轻松地训练、可视化和解释机器学习模型。

它具有对回归和分类模型的内置支持，并以交互方式显示哪些模型用于该任务，以及哪些模型产生了最佳结果。由数据科学家决定将哪个模型用于该任务。训练和优化都像函数调用一样简单。

该库还提供了一个选项，用博弈论算法来解释机器学习模型，如**SHAP**(**Shapely Additive explations**)，也是通过一个函数调用。

PyCaret 仍然需要一些人的参与。然而，通常模型的初始化和训练过程必须由用户明确选择，这打破了全自动解决方案的想法。

此外，PyCaret 对于较大的数据集运行和优化可能会很慢。接下来让我们看看一个无代码的 AutoML 解决方案。

## 显然地

并非所有人都知道如何开发机器学习模型，甚至是如何编写代码。这就是拖放解决方案发挥作用的地方。很明显，AI 肯定是最好的之一，而且也很容易使用。

该服务允许浏览器内的模型训练和评估，甚至可以解释模型所做决策背后的推理。对于机器学习不是核心业务的公司来说，这是显而易见的，因为它很容易开始，并且几乎不像整个数据科学团队那样昂贵。

像这样的服务的一个大问题是价格。总会包含一个免费计划，但在这种特殊情况下，它仅限于少于 50，000 行的数据集。这对于偶尔的测试来说完全没问题，但是对于大多数生产用例来说却是一个障碍。

第二个障碍是真正的自动化。你不能轻易地自动化鼠标点击和数据集加载。这项服务完全自动化了机器学习过程本身，但你仍然需要做一些手工工作。

## TPOT

缩写 **TPOT** 代表**基于树的管道优化工具**。这是一个 Python 库，旨在以自动化的方式处理机器学习任务。

以下是来自官方文档的声明:

把 TPOT 当成你的数据科学助理。TPOT 是一个 Python 自动化机器学习工具，使用遗传编程优化机器学习管道( *TPOT 文档页，TPOT 团队；2019 年 11 月 5 日*)。

遗传编程是一个术语，将在后面的章节中进一步讨论。现在，只要知道它是基于**进化算法**——一种特殊类型的算法，用于发现人类不知道如何解决的问题的解决方案。

在某种程度上，TPOT *是*你的数据科学助手。您可以使用它来自动化数据科学项目中的所有枯燥工作。术语“无聊”是主观的，但在整本书中，我们用它来指代手动选择和调整机器学习模型的任务(阅读:花费数天时间等待模型调整)。

TPOT 无法自动化数据收集和清理过程，原因很明显——机器无法读取你的想法。然而，它可以在准备充分的数据集上比大多数数据科学家更好地执行机器学习任务。

接下来的章节将详细讨论这个库。

# 总结

你在这一部分学到了很多，或者至少简单回顾了一下。你现在对机器学习、回归、分类和自动化的概念很熟悉。所有这些对于接下来要求更高的部分都至关重要。

下一章之后的章节将深入代码，所以你将完全掌握这个库。从最基本的回归和分类自动化，到并行训练，神经网络和模型部署的一切都将被讨论。

在下一章，我们将深入研究 TPOT 库，它的用例，以及它的底层架构。我们将讨论 TPOT 背后的核心原理——遗传编程——以及它是如何用于解决回归和分类任务的。我们还将为 Windows、macOS 和 Linux 操作系统全面配置环境。

# 问&答

1.  用你自己的话来定义“机器学习”这个术语
2.  用几句话解释监督学习。
3.  回归和分类机器学习任务有什么区别？
4.  说出三个使用机器学习的领域，并提供具体的例子。
5.  你如何描述自动化？
6.  为什么在这个时代我们需要自动化？
7.  “带机器学习的自动化”和“机器学习自动化”这两个术语有什么区别？
8.  术语“机器学习”和“自动化”是同义词吗？解释一下你的答案。
9.  说明人工机器学习中参数太多的问题。
10.  定义并简要解释 AutoML。

# 延伸阅读

以下是我们在本章中引用的资源:

*   *机器学习简史*:[https://www . data versity . net/A-Brief-History-of-Machine-Learning/](https://www.dataversity.net/a-brief-history-of-machine-learning/)
*   *什么是机器学习？一个定义*:[https://expertsystem.com/machine-learning-definition/](https://expertsystem.com/machine-learning-definition/)
*   *机器学习*:[https://www.investopedia.com/terms/m/machine-learning.asp](https://www.investopedia.com/terms/m/machine-learning.asp)
*   *机器学习定义*:[https://deepai . org/Machine-Learning-glossary-and-terms/Machine-Learning](https://deepai.org/machine-learning-glossary-and-terms/machine-learning)
*   *什么是自动化？*:[https://www.ibm.com/topics/automation](https://www.ibm.com/topics/automation)
*   *https://github.com/EpistasisLab/tpot*:[TPOT](https://github.com/EpistasisLab/tpot)